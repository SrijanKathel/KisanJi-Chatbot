<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>KisanJi Farmer Support Chat</title>
<style>
  * { margin:0; padding:0; box-sizing: border-box; }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }
  .chat-container {
    background: white;
    width: 100%; max-width: 800px; height: 700px;
    border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    overflow: hidden; display: flex; flex-direction: column; position: relative;
  }
  .header {
    background: linear-gradient(135deg,#4CAF50 0%,#2E7D32 100%);
    color: white; padding:25px 30px; display: flex; align-items:center; gap:15px;
    position:relative; overflow:hidden;
  }
  .bot-avatar { width:50px;height:50px; background:linear-gradient(135deg,#81C784 0%,#66BB6A 100%);
    border-radius:50%; display:flex; align-items:center; justify-content:center;font-size:30px;position:relative;z-index:1; }
  .header-text { position:relative;z-index:1; }
  .header h1 { font-size:24px; font-weight:600; margin-bottom:5px; }
  .header p { font-size:14px; opacity:0.9; }
  .language-selector { margin-left:auto; margin-right:15px; position:relative;z-index:1; }
  .language-selector select {
    background:rgba(255,255,255,0.2); color:white; border:1px solid rgba(255,255,255,0.3);
    border-radius:20px; padding:8px 15px; font-size:12px; cursor:pointer; outline:none;
    appearance:none; background-image:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M7 10l5 5 5-5z"/></svg>');
    background-repeat:no-repeat; background-position:right 8px center; background-size:16px;
    padding-right:35px; transition: all 0.3s ease;
  }
  .language-selector select:hover { background:rgba(255,255,255,0.3); border-color:rgba(255,255,255,0.5);}
  .status-indicator {width:12px; height:12px; background:#4CAF50; border-radius:50%; border:2px solid white;
    margin-left:auto; animation:pulse 2s infinite;position:relative;z-index:1;}
  @keyframes pulse {0%{box-shadow:0 0 0 0 rgba(76,175,80,0.7);} 70%{box-shadow:0 0 0 10px rgba(76,175,80,0);} 100%{box-shadow:0 0 0 0 rgba(76,175,80,0);}}
  #chatbox { flex:1; padding:20px 30px; overflow-y:auto; background:linear-gradient(to bottom, #f8fdf8 0%, #ffffff 100%);
    position:relative; }
  #chatbox::-webkit-scrollbar { width:6px; }
  #chatbox::-webkit-scrollbar-track { background:rgba(0,0,0,0.05);border-radius:10px;}
  #chatbox::-webkit-scrollbar-thumb { background:rgba(76,175,80,0.3);border-radius:10px;}
  #chatbox::-webkit-scrollbar-thumb:hover { background:rgba(76,175,80,0.5);}
  .message { margin:15px 0; display:flex; align-items:flex-start; gap:12px; animation:slideIn 0.3s ease-out; z-index:1;}
  @keyframes slideIn { from{ opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }
  .user { flex-direction: row-reverse;}
  .message-avatar { width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:20px; flex-shrink:0;}
  .user .message-avatar { background:linear-gradient(135deg,#2196F3 0%,#1976D2 100%); color: white; }
  .bot .message-avatar { background:linear-gradient(135deg,#4CAF50 0%,#2E7D32 100%); color: white;}
  .message-content { max-width:70%; padding:15px 20px; border-radius:20px; font-size:14px; line-height:1.5;
    position:relative; word-wrap:break-word;}
  .user .message-content { background:linear-gradient(135deg,#2196F3 0%,#1976D2 100%); color:white; border-bottom-right-radius:5px;}
  .bot .message-content { background:linear-gradient(135deg,#E8F5E8 0%,#F1F8E9 100%); color:#2E7D32;
    border:1px solid rgba(76,175,80,0.2); border-bottom-left-radius:5px;}
  .error-message { padding: 15px 20px; background:linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
    color: #c62828; border-radius: 20px; border-bottom-left-radius: 5px; border: 1px solid rgba(244,67,54,0.2); font-size: 14px; line-height: 1.5;}
  .welcome-message { text-align:center; padding:40px 20px; color:#666; position:relative; z-index:1;}
  .welcome-message h3 { color:#2E7D32; margin-bottom:10px; font-size:18px;}
  .welcome-message p { font-size:14px; line-height:1.6; }
  .agriculture-icons { display:flex;justify-content:center;gap:20px;margin:20px 0;font-size:24px;}

  .input-section { padding:20px 30px; background:white; border-top:1px solid rgba(0,0,0,0.1); display:flex; flex-direction:column;}

  .template-container {
    display: flex;
    gap: 8px;
    padding: 6px 12px;
    overflow-x: auto;
    background: #e8f5e8;
    border-radius: 25px;
    margin-bottom: 10px;
    font-size: 13px;
  }

  .template-pill {
    background: #4CAF50;
    color: white;
    padding: 6px 14px;
    border-radius: 18px;
    cursor: pointer;
    white-space: nowrap;
    user-select: none;
    transition: background 0.3s ease;
  }
  .template-pill:hover { background: #388E3C; }

  #inputForm { display: flex; gap: 10px; align-items: center;}
  #userInput { flex: 1;padding: 15px 20px; border:2px solid rgba(76,175,80,0.2);
    border-radius:25px; font-size:14px; background:#f9f9f9; transition:all 0.3s ease; outline:none;}
  #userInput:focus { border-color: #4CAF50; background: white; box-shadow:0 0 0 3px rgba(76,175,80,0.1);}
  #userInput::placeholder { color: #999; }
  #voiceBtn, #imageBtn { background:transparent; border:none; font-size:24px; cursor:pointer;user-select:none; outline:none; padding:5px; color:#4CAF50; transition:color 0.3s ease;}
  #voiceBtn:hover, #imageBtn:hover { color:#2E7D32;}
  .send-button { width:50px;height:50px;border:none;border-radius:50%;
      background:linear-gradient(135deg,#4CAF50 0%,#2E7D32 100%);
      color:white; cursor:pointer; display:flex; align-items:center; justify-content:center;font-size:18px; transition:all 0.3s ease; flex-shrink:0;}
  .send-button:hover { transform:scale(1.1); box-shadow:0 5px 15px rgba(76,175,80,0.4);}
  .send-button:active { transform:scale(0.95);}
  /* Typing indicator styles */
  .typing-indicator {
    display: none;
    align-items: center;
    gap: 12px;
    margin: 12px 0 0 0;
    animation: slideIn 0.24s ease-out;
  }
  .typing-dots {
    display: flex;
    gap: 4px;
    padding: 13px 19px;
    background: linear-gradient(135deg, #E8F5E8 0%, #F1F8E9 100%);
    border-radius: 20px;
    border-bottom-left-radius: 5px;
    border: 1px solid rgba(76, 175, 80, 0.2);
  }
  .typing-dot {
    width: 8px;
    height: 8px;
    background: #4CAF50;
    border-radius: 50%;
    animation: typing 1.4s infinite;
  }
  .typing-dot:nth-child(2) { animation-delay: 0.2s; }
  .typing-dot:nth-child(3) { animation-delay: 0.4s; }
  @keyframes typing {
    0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
    30% { transform: translateY(-10px); opacity: 1; }
  }
</style>
</head>
<body>

<div class="chat-container">
  <div class="header">
    <div class="bot-avatar">üë®‚Äçüåæ</div>
    <div class="header-text">
      <h1 id="headerTitle">KisanJi Farmer Support</h1>
      <p id="headerSubtitle">Your intelligent farming assistant</p>
    </div>
    <div class="language-selector">
      <select id="languageSelect" style="background-color: black;">
        <option value="en" selected>English</option>
        <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
        <option value="pa">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</option>
        <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
        <option value="mr">‡§Æ‡§∞‡§æ‡§†‡•Ä</option>
        <option value="or">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü</option>
        <option value="gu">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</option>
        <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
        <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
        <option value="kn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</option>
        <option value="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</option>
      </select>
    </div>
    <div class="status-indicator"></div>
  </div>
  <div id="chatbox">
    <div class="welcome-message">
      <h3 id="welcomeTitle">Welcome to KisanJi! üöú</h3>
      <div class="agriculture-icons">
        <span>üåæ</span>
        <span>üöú</span>
        <span>üå±</span>
        <span>üåΩ</span>
        <span>üçÖ</span>
      </div>
      <p id="welcomeText">I'm here to help you with crop management, weather insights, pest control, soil health, and all your farming questions. How can I assist you today?</p>
    </div>
  </div>
  <!-- Typing indicator -->
  <div class="typing-indicator" id="typingIndicator">
    <div class="message-avatar">üë®‚Äçüåæ</div>
    <div class="typing-dots">
      <div class="typing-dot"></div>
      <div class="typing-dot"></div>
      <div class="typing-dot"></div>
    </div>
  </div>
  <div class="input-section">
    <div class="template-container" id="templateContainer"></div>
    <form id="inputForm" autocomplete="off">
      <input type="text" id="userInput" placeholder="Ask about crops, weather, pests, soil, or farming techniques..." />
      <button type="button" id="voiceBtn" title="Voice Input" aria-label="Voice Input">üé§</button>
      <button type="button" id="imageBtn" title="Attach Image" aria-label="Attach Image">üì∑</button>
      <button type="submit" class="send-button">‚û§</button>
      <input type="file" id="imageInput" accept="image/*" style="display:none" />
    </form>
  </div>
</div>
<script>
const chatbox = document.getElementById('chatbox');
const inputForm = document.getElementById('inputForm');
const userInput = document.getElementById('userInput');
const typingIndicator = document.getElementById('typingIndicator');
const languageSelect = document.getElementById('languageSelect');
const voiceBtn = document.getElementById('voiceBtn');
const imageBtn = document.getElementById('imageBtn');
const imageInput = document.getElementById('imageInput');

// Template pills multilingual data
const templatePrompts = {
  weather: {
    en: 'Tell me the weather forecast for my location',
    hi: '‡§Æ‡•á‡§∞‡•á ‡§∏‡•ç‡§•‡§æ‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡•å‡§∏‡§Æ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§® ‡§¨‡§§‡§æ‡§è‡§Ç',
    pa: '...'
  },
  cropHealth: {
    en: 'What are common pests for my crops?',
    hi: '‡§Æ‡•á‡§∞‡•á ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡•Ä‡§ü ‡§ï‡•å‡§® ‡§∏‡•á ‡§π‡•à‡§Ç?',
    pa: '...'
  },
  market: {
    en: 'What are the current market prices?',
    hi: '‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡§Ç‡§°‡•Ä ‡§≠‡§æ‡§µ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à‡§Ç?',
    pa: '...'
  },
  schemes: {
    en: 'Tell me about government schemes and subsidies',
    hi: '‡§Æ‡•Å‡§ù‡•á ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ‡§ì‡§Ç ‡§î‡§∞ ‡§∏‡§¨‡•ç‡§∏‡§ø‡§°‡•Ä ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§¨‡§§‡§æ‡§è‡§Ç',
    pa: '...'
  },
  // ---- New Common Questions ----
  fertilizer: {
    en: 'Recommended fertilizer for wheat',
    hi: '‡§ó‡•á‡§π‡•Ç‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•å‡§® ‡§∏‡§æ ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï ‡§â‡§ö‡§ø‡§§ ‡§π‡•à?',
    pa: '...'
  },
  irrigation: {
    en: 'How often should I irrigate rice?',
    hi: '‡§ß‡§æ‡§® ‡§ï‡•Ä ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§ï‡§ø‡§§‡§®‡•Ä ‡§¨‡§æ‡§∞ ‡§ï‡§∞‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è?',
    pa: '...'
  },
  loanInfo: {
    en: 'How to apply for a Kisan credit card?',
    hi: '‡§ï‡§ø‡§∏‡§æ‡§® ‡§ï‡•ç‡§∞‡•á‡§°‡§ø‡§ü ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡•á‡§¶‡§® ‡§ï‡•à‡§∏‡•á ‡§ï‡§∞‡•á‡§Ç?',
    pa: '...'
  }
  // other: {
  //   en: 'Ask me anything about farming...',
  //   hi: '‡§ï‡•É‡§∑‡§ø ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ ‡§≠‡•Ä ‡§™‡•Ç‡§õ‡•á‡§Ç...',
  //   pa: '...'
  // }
};

const templateLabels = {
  weather: {en:'Weather',hi:'‡§Æ‡•å‡§∏‡§Æ',pa:'‡®Æ‡©å‡®∏‡®Æ'},
  cropHealth: {en:'Pests',hi:'‡§ï‡•Ä‡§ü',pa:'‡®ï‡©Ä‡©ú‡©á'},
  market: {en:'Market',hi:'‡§Æ‡§Ç‡§°‡•Ä',pa:'‡®Æ‡©∞‡®°‡©Ä'},
  schemes: {en:'Schemes',hi:'‡§Ø‡•ã‡§ú‡§®‡§æ',pa:'‡®Ø‡©ã‡®ú‡®®‡®æ'},
  fertilizer: {en:'Wheat Fertilizer',hi:'‡§ó‡•á‡§π‡•Ç‡§Ç ‡§ñ‡§æ‡§¶',pa:'...'},
  irrigation: {en:'Rice Irrigation',hi:'‡§ß‡§æ‡§® ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à',pa:'...'},
  loanInfo: {en:'KCC Apply',hi:'‡§ï‡•á‡§∏‡•Ä‡§∏‡•Ä ‡§Ü‡§µ‡•á‡§¶‡§®',pa:'...'}
  //other: {en:'Other Topics',hi:'‡§Ö‡§®‡•ç‡§Ø ‡§µ‡§ø‡§∑‡§Ø',pa:'‡®π‡©ã‡®∞ ‡®µ‡®ø‡®∏‡®º‡©á'}
};

const translations = {
  en: {
    headerTitle: "KisanJi Farmer Support",
    headerSubtitle: "Your intelligent farming assistant",
    welcomeTitle: "Welcome to KisanJi! üöú",
    welcomeText: "I'm here to help you with crop management, weather insights, pest control, soil health, and all your farming questions. How can I assist you today?",
    inputPlaceholder: "Ask about crops, weather, pests, soil, or farming techniques...",
    errorMessage: "Sorry, I'm having trouble connecting right now. Please check your internet connection and try again. üåê",
    title: "KisanJi Farmer Support Chat"
  },
  hi: {
    headerTitle: "‡§ï‡§ø‡§∏‡§æ‡§®‡§ú‡•Ä ‡§ï‡§ø‡§∏‡§æ‡§® ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ",
    headerSubtitle: "‡§Ü‡§™‡§ï‡§æ ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§Æ‡§æ‡§® ‡§ï‡•É‡§∑‡§ø ‡§∏‡§π‡§æ‡§Ø‡§ï",
    welcomeTitle: "‡§ï‡§ø‡§∏‡§æ‡§®‡§ú‡•Ä ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à! üöú",
    welcomeText: "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®, ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä, ‡§ï‡•Ä‡§ü ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£, ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•á ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø, ‡§î‡§∞ ‡§∏‡§≠‡•Ä ‡§ï‡•É‡§∑‡§ø ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡•Ä ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π‡§æ‡§Ç ‡§π‡•Ç‡§Ç‡•§ ‡§Ü‡§ú ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•à‡§∏‡•á ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç?",
    inputPlaceholder: "‡§´‡§∏‡§≤, ‡§Æ‡•å‡§∏‡§Æ, ‡§ï‡•Ä‡§ü, ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä, ‡§Ø‡§æ ‡§ï‡•É‡§∑‡§ø ‡§§‡§ï‡§®‡•Ä‡§ï‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§õ‡•á‡§Ç...",
    errorMessage: "‡§Æ‡§æ‡§´‡§º ‡§ï‡§∞‡•á‡§Ç, ‡§Æ‡•Å‡§ù‡•á ‡§Ö‡§≠‡•Ä ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§™‡§∞‡•á‡§∂‡§æ‡§®‡•Ä ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡§æ ‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§ üåê",
    title: "‡§ï‡§ø‡§∏‡§æ‡§®‡§ú‡•Ä ‡§ï‡§ø‡§∏‡§æ‡§® ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§ö‡•à‡§ü"
  },
  pa: {
    headerTitle: "‡®ï‡®ø‡®∏‡®æ‡®®‡®ú‡©Ä ‡®ï‡®ø‡®∏‡®æ‡®® ‡®∏‡®π‡®æ‡®á‡®§‡®æ",
    headerSubtitle: "‡®§‡©Å‡®π‡®æ‡®°‡®æ ‡®¨‡©Å‡©±‡®ß‡©Ä‡®Æ‡®æ‡®® ‡®ñ‡©á‡®§‡©Ä ‡®∏‡®π‡®æ‡®á‡®ï",
    welcomeTitle: "‡®ï‡®ø‡®∏‡®æ‡®®‡®ú‡©Ä ‡®µ‡®ø‡©±‡®ö ‡®§‡©Å‡®π‡®æ‡®°‡®æ ‡®∏‡©Å‡®Ü‡®ó‡®§ ‡®π‡©à! üöú",
    welcomeText: "‡®Æ‡©à‡®Ç ‡®§‡©Å‡®π‡®æ‡®°‡©Ä ‡®´‡®∏‡®≤ ‡®™‡©ç‡®∞‡®¨‡©∞‡®ß‡®®, ‡®Æ‡©å‡®∏‡®Æ ‡®¶‡©Ä ‡®ú‡®æ‡®£‡®ï‡®æ‡®∞‡©Ä, ‡®ï‡©Ä‡©ú‡©á ‡®®‡®ø‡®Ø‡©∞‡®§‡®∞‡®£, ‡®Æ‡®ø‡©±‡®ü‡©Ä ‡®¶‡©Ä ‡®∏‡®ø‡®π‡®§, ‡®Ö‡®§‡©á ‡®∏‡®æ‡®∞‡©á ‡®ñ‡©á‡®§‡©Ä ‡®∏‡©∞‡®¨‡©∞‡®ß‡©Ä ‡®∏‡®µ‡®æ‡®≤‡®æ‡®Ç ‡®µ‡®ø‡©±‡®ö ‡®Æ‡®¶‡®¶ ‡®ï‡®∞‡®® ‡®≤‡®à ‡®á‡©±‡®•‡©á ‡®π‡®æ‡®Ç‡•§ ‡®Ö‡©±‡®ú ‡®Æ‡©à‡®Ç ‡®§‡©Å‡®π‡®æ‡®°‡©Ä ‡®ï‡®ø‡®µ‡©á‡®Ç ‡®∏‡®π‡®æ‡®á‡®§‡®æ ‡®ï‡®∞ ‡®∏‡®ï‡®¶‡®æ ‡®π‡®æ‡®Ç?",
    inputPlaceholder: "‡®´‡®∏‡®≤‡®æ‡®Ç, ‡®Æ‡©å‡®∏‡®Æ, ‡®ï‡©Ä‡©ú‡©á, ‡®Æ‡®ø‡©±‡®ü‡©Ä, ‡®ú‡®æ‡®Ç ‡®ñ‡©á‡®§‡©Ä ‡®§‡®ï‡®®‡©Ä‡®ï‡®æ‡®Ç ‡®¨‡®æ‡®∞‡©á ‡®™‡©Å‡©±‡®õ‡©ã...",
    errorMessage: "‡®Æ‡®æ‡®´‡®º ‡®ï‡®∞‡®®‡®æ, ‡®Æ‡©à‡®®‡©Ç‡©∞ ‡®π‡©Å‡®£‡©á ‡®ï‡®®‡©à‡®ï‡®ü ‡®ï‡®∞‡®® ‡®µ‡®ø‡©±‡®ö ‡®Æ‡©Å‡®∏‡®º‡®ï‡®≤ ‡®Ü ‡®∞‡®π‡©Ä ‡®π‡©à‡•§ ‡®ï‡®ø‡®∞‡®™‡®æ ‡®ï‡®∞‡®ï‡©á ‡®Ü‡®™‡®£‡®æ ‡®á‡©∞‡®ü‡®∞‡®®‡©à‡®ü ‡®ï‡®®‡©à‡®ï‡®∏‡®º‡®® ‡®ú‡®æ‡®Ç‡®ö‡©ã ‡®Ö‡®§‡©á ‡®¶‡©Å‡®¨‡®æ‡®∞‡®æ ‡®ï‡©ã‡®∏‡®º‡®ø‡®∏‡®º ‡®ï‡®∞‡©ã‡•§ üåê",
    title: "‡®ï‡®ø‡®∏‡®æ‡®®‡®ú‡©Ä ‡®ï‡®ø‡®∏‡®æ‡®® ‡®∏‡®π‡®æ‡®á‡®§‡®æ ‡®ö‡©à‡®ü"
  }
};

let currentLanguage = 'en';
let chatHistory = [];

function updateLanguage(lang) {
  currentLanguage = lang;
  const translation = translations[lang] || translations['en'];
  document.title = translation.title;
  document.getElementById('headerTitle').textContent = translation.headerTitle;
  document.getElementById('headerSubtitle').textContent = translation.headerSubtitle;
  const welcomeTitle = document.getElementById('welcomeTitle');
  const welcomeText = document.getElementById('welcomeText');
  if (welcomeTitle) welcomeTitle.textContent = translation.welcomeTitle;
  if (welcomeText) welcomeText.textContent = translation.welcomeText;
  userInput.placeholder = translation.inputPlaceholder;
  renderTemplates(lang);
}
const templateContainer = document.getElementById('templateContainer');
function renderTemplates(lang) {
  templateContainer.innerHTML = '';
  for (const topic in templatePrompts) {
    if (templatePrompts.hasOwnProperty(topic)) {
      const pill = document.createElement('div');
      pill.className = 'template-pill';
      pill.textContent = templateLabels[topic][lang] || templateLabels[topic]['en'];
      pill.title = templatePrompts[topic][lang] || templatePrompts[topic]['en'];
      pill.dataset.topic = topic;
      pill.addEventListener('click', () => {
        userInput.value = templatePrompts[topic][lang] || templatePrompts[topic]['en'];
        userInput.focus();
      });
      templateContainer.appendChild(pill);
    }
  }
}
languageSelect.addEventListener('change', (e) => { updateLanguage(e.target.value); });

// Main chat functions
function appendMessage(text, sender) {
  const messageDiv = document.createElement('div');
  messageDiv.classList.add('message', sender);
  const avatar = document.createElement('div');
  avatar.classList.add('message-avatar');
  avatar.textContent = sender === 'user' ? 'üë©‚Äçüåæ' : 'üë®‚Äçüåæ';
  const content = document.createElement('div');
  content.classList.add('message-content');
  content.textContent = text;
  messageDiv.appendChild(avatar);
  messageDiv.appendChild(content);
  chatbox.appendChild(messageDiv);
  chatbox.scrollTop = chatbox.scrollHeight;
  chatHistory.push({ text, sender, timestamp: new Date() });
}
function appendErrorMessage(text) {
  const messageDiv = document.createElement('div');
  messageDiv.classList.add('message', 'bot');
  const avatar = document.createElement('div');
  avatar.classList.add('message-avatar');
  avatar.textContent = 'üë®‚Äçüåæ';
  const content = document.createElement('div');
  content.classList.add('error-message');
  content.textContent = text;
  messageDiv.appendChild(avatar);
  messageDiv.appendChild(content);
  chatbox.appendChild(messageDiv);
  chatbox.scrollTop = chatbox.scrollHeight;
}

// Typing indicator logic
function showTyping() {
  typingIndicator.style.display = 'flex';
  chatbox.appendChild(typingIndicator);
  chatbox.scrollTop = chatbox.scrollHeight;
}
function hideTyping() {
  typingIndicator.style.display = 'none';
  if (typingIndicator.parentNode) {
    typingIndicator.parentNode.removeChild(typingIndicator);
  }
}

// Demo bot API function (replace with your real API)
// async function sendMessageToBot(message, language) {
//   return new Promise(res => setTimeout(() => res({success:true, message:"This is a simulated bot reply to: " + message}),1200));
// }


const queryResponsePair = {
  "What are the best crops to grow in my region?": "The best crops depend on soil type, climate, and water availability. For example, wheat and barley thrive in cooler climates, while rice and sugarcane need warmer, wetter conditions. Consulting local agricultural extension services can provide region-specific guidance.",
  "How can I improve my soil fertility?": "Soil fertility can be improved by adding organic matter such as compost or manure, practicing crop rotation, using cover crops to prevent erosion, and minimizing chemical fertilizer use to maintain microbial balance.",
  "What is the best irrigation method for water conservation?": "Drip irrigation is highly water-efficient as it delivers water directly to the plant roots, reducing evaporation and runoff. It is suitable for a wide range of crops, especially in arid areas.",
  "How to identify and control pests naturally?": "Integrated Pest Management (IPM) techniques such as using biological control agents (e.g., ladybugs for aphids), crop rotation, and organic sprays like neem oil can effectively control pests without harmful chemicals.",
  "When is the best time to sow seeds?": "Seed sowing times vary by crop and region. Generally, sow seeds at the start of the expected rainy season or following local agricultural calendars to maximize yield.",
  "What fertilizers should I use for my crops?": "Use balanced fertilizers based on soil tests. Nitrogen, phosphorus, and potassium are essential, but micronutrients like zinc and boron may also be needed. Organic fertilizers are a sustainable alternative.",
  "How to deal with crop diseases?": "Regularly inspect plants for symptoms and use disease-resistant crop varieties. Applying recommended fungicides and maintaining good field sanitation helps control spread.",
  "What are the signs of soil erosion and how to prevent it?": "Signs include loss of topsoil, reduced water retention, and exposed roots. Prevention methods include terracing, contour plowing, using cover crops, and maintaining ground cover.",
  "How can I increase crop yield sustainably?": "Adopt best practices like integrated nutrient management, proper irrigation scheduling, pest and disease management, and crop diversification.",
  "What role does organic farming play?": "Organic farming promotes soil health, biodiversity, and reduces chemical inputs, creating sustainable systems and healthier produce.",
  "How to store harvested crops effectively?": "Store crops in cool, dry, and ventilated places using pest-proof containers. Proper drying before storage reduces spoilage.",
  "What is crop rotation and why is it important?": "Crop rotation involves changing the type of crop grown in a field each season to reduce pests and diseases, improve soil fertility, and disrupt weed cycles.",
  "How do I use weather forecasts for farming decisions?": "Use weather forecasts to schedule planting, irrigation, pest control, and harvesting to reduce losses and improve efficiency.",
  "Can I use technology on my farm?": "Yes, technologies like soil sensors, drones, weather apps, and mobile advisories help monitor crops and optimize resource use.",
  "What are common signs of nutrient deficiency in plants?": "Yellowing leaves may indicate nitrogen deficiency; purple leaves could signal phosphorus shortage. Leaf spots and curling often indicate potassium or micronutrient problems.",
  "How to protect my farm from drought?": "Use drought-tolerant crops, mulch to retain soil moisture, implement rainwater harvesting, and efficient irrigation like drip systems.",
  "What are the benefits of cover cropping?": "Cover crops prevent erosion, improve soil organic matter, fix nitrogen, suppress weeds, and enhance soil structure.",
  "How do I manage farm waste sustainably?": "Compost organic waste, recycle plastics, and use biodegradable materials to reduce environmental impact.",
  "What safety precautions should I take when using pesticides?": "Wear protective gear, follow label instructions strictly, avoid spraying in windy conditions, and store pesticides safely away from children and animals.",
  "How to start a small-scale organic farm?": "Begin with soil testing, select suitable crops, source organic seeds, learn organic pest and nutrient management, and connect with local organic markets."
};

function delay(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

async function sendMessageToBot(message, language, delayMs = 2000) {
  await delay(delayMs); // wait delayMs milliseconds

  const answer = queryResponsePair[message];
  if (answer) {
    return { success: true, message: answer };
  } else {
    return { success: false, error: "Sorry, I do not have an answer for that question." };
  }
}


// function delay(ms) {
//   return new Promise(resolve => setTimeout(resolve, ms));
// }

// async function sendMessageToBot(message, language, delayMs = ) {
//   try {
//     if (delayMs > 0) {
//       await delay(delayMs);  // Wait for delayMs milliseconds before API call
//     }

//     const response = await fetch('http://127.0.0.1:5000/chat', {  // Change the URL as needed
//       method: 'POST',
//       headers: { 'Content-Type': 'application/json' },
//       body: JSON.stringify({ message: message, language: language })
//     });

//     if (!response.ok) throw new Error('Network error ' + response.status);

//     const data = await response.json();
//     return { success: true, message: data.response };
//   } catch (error) {
//     console.error('API Error:', error);
//     return { success: false, error: error.message };
//   }
// }


// Handle form submit/chat
inputForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  const message = userInput.value.trim();
  if (!message) return;
  const welcomeMessage = document.querySelector('.welcome-message');
  if (welcomeMessage) welcomeMessage.remove();
  appendMessage(message, 'user');
  userInput.value = '';
  userInput.disabled = true;
  showTyping();
  try {
    const result = await sendMessageToBot(message, currentLanguage);
    hideTyping();
    if (result.success) {
      appendMessage(result.message, 'bot');
    } else {
      appendErrorMessage(translations[currentLanguage]?.errorMessage || translations['en'].errorMessage);
    }
  } catch (error) {
    hideTyping();
    appendErrorMessage(translations[currentLanguage]?.errorMessage || translations['en'].errorMessage);
  } finally {
    userInput.disabled = false;
    userInput.focus();
  }
});

// Voice input
voiceBtn.addEventListener('click', () => {
  if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
    alert('Sorry, your browser does not support voice recognition.');
    return;
  }
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  const recognition = new SpeechRecognition();
  recognition.lang = currentLanguage === 'en' ? 'en-US' : currentLanguage;
  recognition.interimResults = false;
  recognition.maxAlternatives = 1;
  recognition.start();
  voiceBtn.disabled = true;
  recognition.onresult = (event) => {
    const transcript = event.results[0][0].transcript;
    userInput.value = transcript;
    voiceBtn.disabled = false;
    userInput.focus();
  };
  recognition.onerror = (event) => {
    alert('Voice recognition error: ' + event.error);
    voiceBtn.disabled = false;
  };
  recognition.onend = () => { voiceBtn.disabled = false; };
});

// Image upload
imageBtn.addEventListener('click', () => {
  imageInput.click();
});
imageInput.addEventListener('change', async () => {
  const file = imageInput.files[0];
  if (!file) return;
  if (!file.type.startsWith('image/')) {
    alert('Please select a valid image file.');
    return;
  }
  appendMessage('üì∑ Image sent (feature demo placeholder)', 'user');
  userInput.disabled = true;
  showTyping();
  // Simulate image upload reply
  setTimeout(() => {
    hideTyping();
    appendMessage("Bot received your image. (simulated)", 'bot');
    userInput.disabled = false;
    userInput.focus();
    imageInput.value = '';
  }, 1200);
});

userInput.focus();
userInput.addEventListener('keypress', (e) => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    inputForm.dispatchEvent(new Event('submit'));
  }
});
updateLanguage(currentLanguage);
</script>
</body>
</html>
